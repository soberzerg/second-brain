# –û—Ç—á—ë—Ç –ø–æ –∞–Ω–∞–ª–∏–∑—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

## A01:2021 ‚Äî –ù–∞—Ä—É—à–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–æ—Å—Ç—É–ø–∞

### IDOR –ø—Ä–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–∏ —Ñ–∞–π–ª–∞ (UUIDFileController)

**Severity:** üö® **CRITICAL**

**CWE:** CWE-639

**–û–ø–∏—Å–∞–Ω–∏–µ:**

–ú–µ—Ç–æ–¥ `UUIDFileController::download` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç UUID —Ñ–∞–π–ª–∞ –∏ –¥–µ–ª–µ–≥–∏—Ä—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –≤ `UUIDFileService::download`, –Ω–µ –≤—ã–ø–æ–ª–Ω—è—è –Ω–∏–∫–∞–∫–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞. –ü—Ä–∏–≤—è–∑–∫–∞ –º–æ–¥–µ–ª–∏ `File` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç scope `accessible`, –∞ —Å–µ—Ä–≤–∏—Å –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç, —á—Ç–æ –¥–æ—Å—Ç—É–ø —É–∂–µ –±—ã–ª –ø—Ä–æ–≤–µ—Ä–µ–Ω.

**–°—Ü–µ–Ω–∞—Ä–∏–π –∞—Ç–∞–∫–∏:**

–ê—Ç–∞–∫—É—é—â–∏–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è –≤ API –∏ —É–∑–Ω–∞—ë—Ç UUID –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–∑ —É—Ç—ë–∫—à–∏—Ö –ª–æ–≥–æ–≤, –∏–∑ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π UUID –∏–ª–∏ –ø–µ—Ä–µ–±–æ—Ä–æ–º). –ó–∞—Ç–µ–º –æ–Ω –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç GET-–∑–∞–ø—Ä–æ—Å –Ω–∞ `/api/explorer/uuid-file/{target_uuid}/download`. –°–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ –≤ ZIP-–∞—Ä—Ö–∏–≤–µ, –Ω–µ –ø—Ä–æ–≤–µ—Ä—è—è, –µ—Å—Ç—å –ª–∏ —É –∞—Ç–∞–∫—É—é—â–µ–≥–æ –ø—Ä–∞–≤–æ –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–º—É —Ñ–∞–π–ª—É.

**–í–ª–∏—è–Ω–∏–µ:**

–ù–∞—Ä—É—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏. –ù–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç —Å–∫–∞—á–∞—Ç—å –ª—é–±–æ–π —Ñ–∞–π–ª, —Ö—Ä–∞–Ω—è—â–∏–π—Å—è –≤ —Å–∏—Å—Ç–µ–º–µ, –µ—Å–ª–∏ –∑–Ω–∞—é—Ç –µ–≥–æ UUID.

**–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞:**

- **–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `app/Http/Controllers/UUIDFileController.php`  
  - **–î–µ—Ç–∞–ª–∏:** –º–µ—Ç–æ–¥ `download` –¥–µ–ª–µ–≥–∏—Ä—É–µ—Ç –≤ —Å–µ—Ä–≤–∏—Å –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–æ–∫.  
- **–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `app/Services/UUIDFileService.php`  
  - **–î–µ—Ç–∞–ª–∏:** –º–µ—Ç–æ–¥ `download` —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç ZIP –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–æ–∫ –¥–æ—Å—Ç—É–ø–∞.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**

–ü–æ–Ω—è—Ç–Ω–æ, —á—Ç–æ –ø–æ –º–µ—Ö–∞–Ω–∏–∫–µ –∏ —Å—É—Ç–∏ —Å–µ—Ä–≤–∏—Å–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç—É –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏. –ù–æ –¥–ª—è —É—Å–ª–æ–∂–Ω–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ "–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π" –º–æ–∂–µ—Ç —Å—á–∏—Ç–∞—Ç—å—Å—è —É–Ω–∏–∫–∞–ª—å–Ω–∞—è –ø–æ–¥–ø–∏—Å—å, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –≤ –∑–∞–ø—Ä–æ—Å–µ (—Ç–∞–º –∂–µ, –≤ URL). –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –∑–∞—â–∏—Ç–æ–π –æ—Ç –ø–µ—Ä–µ–±–æ—Ä–∞ UUID –±—É–¥–µ—Ç –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å (–ø–æ –ø—Ä–∏–º–µ—Ä—É —à–∞—Ä–∏–Ω–≥–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ Google Docs).

---

### IDOR –ø—Ä–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–∞ (UUIDFileController)

**Severity:** üö® **CRITICAL**

**CWE:** CWE-639

**–û–ø–∏—Å–∞–Ω–∏–µ:**

–ú–µ—Ç–æ–¥ `UUIDFileController::show` —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª–∞. –•–æ—Ç—è –æ–Ω –ø—ã—Ç–∞–µ—Ç—Å—è –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç —Ä–∞–±–æ—á–µ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ (workspace), –≤ –Ω—ë–º –Ω–µ—Ç –ø—Ä—è–º–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–ª–∞–¥–µ–Ω–∏—è, —á–ª–µ–Ω—Å—Ç–≤–∞ –≤ –≥—Ä—É–ø–ø–µ) –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ñ–∞–π–ª.

**–°—Ü–µ–Ω–∞—Ä–∏–π –∞—Ç–∞–∫–∏:**

–ê—Ç–∞–∫—É—é—â–∏–π –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç GET-–∑–∞–ø—Ä–æ—Å –Ω–∞ `/api/explorer/uuid-file/{target_uuid}`. –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫—É —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ workspace, –Ω–æ –Ω–µ —É–±–µ–∂–¥–∞–µ—Ç—Å—è, —á—Ç–æ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –µ—Å—Ç—å –ø—Ä–∞–≤–æ —á—Ç–µ–Ω–∏—è —ç—Ç–æ–≥–æ —Ñ–∞–π–ª–∞ –≤–Ω—É—Ç—Ä–∏ –¥–∞–Ω–Ω–æ–≥–æ workspace. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —Å–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª–∞.

**–í–ª–∏—è–Ω–∏–µ:**

–ù–∞—Ä—É—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏. –ù–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (–∏–º—è, —Ä–∞–∑–º–µ—Ä, –≤–ª–∞–¥–µ–ª–µ—Ü –∏ —Ç. –ø.) –ª—é–±–æ–≥–æ —Ñ–∞–π–ª–∞.

**–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞:**

- **–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `app/Http/Controllers/UUIDFileController.php`  
  - **–î–µ—Ç–∞–ª–∏:** –≤ –º–µ—Ç–æ–¥–µ `show` –Ω–µ—Ç —è–≤–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫ —Ñ–∞–π–ª—É.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**

–¢–æ –∂–µ —Å–∞–º–æ–µ, —á—Ç–æ –∏ –≤ –ø–µ—Ä–≤–æ–º —Å–ª—É—á–∞–µ.

## A02:2021 ‚Äî –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–ª–∞–±–æ–≥–æ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–∏–º–∏—Ç–∏–≤–∞ (`crypt`) —Å–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–æ–ª—å—é

**Severity:** üö® **CRITICAL**

**CWE:** CWE-327

**–û–ø–∏—Å–∞–Ω–∏–µ:**

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é `crypt()` —Å –∂—ë—Å—Ç–∫–æ –∑–∞–¥–∞–Ω–Ω–æ–π —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–æ–ª—å—é (`'d24'`) –¥–ª—è ¬´—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è¬ª –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å—Å—ã–ª–æ–∫ ¬´No Auth¬ª. `crypt()` —Å —Ç–∞–∫–æ–π —Å–æ–ª—å—é –∫—Ä–∞–π–Ω–µ —Å–ª–∞–± (–≤–µ—Ä–æ—è—Ç–Ω–æ, DES- –∏–ª–∏ MD5-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π) –∏ –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –≤ `validateHash` –æ–ø–∏—Ä–∞–µ—Ç—Å—è –Ω–∞ —ç—Ç–æ —Å–ª–∞–±–æ–µ ¬´—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ¬ª, –ø–æ—ç—Ç–æ–º—É –µ—ë –º–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏.

**–°—Ü–µ–Ω–∞—Ä–∏–π –∞—Ç–∞–∫–∏:**

–ê—Ç–∞–∫—É—é—â–∏–π, –∑–Ω–∞—è `workspace_id` –∏ `file_signature_id` (–∏—Ö –º–æ–∂–Ω–æ –ø–µ—Ä–µ–±–∏—Ä–∞—Ç—å/–ø–µ—Ä–µ—á–∏—Å–ª—è—Ç—å), –º–æ–∂–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Å—Ç—Ä–æ–∫—É `encrypted` —á–µ—Ä–µ–∑ `crypt(..., 'd24')`, —Ç–∞–∫ –∫–∞–∫ —Å–æ–ª—å —Å—Ç–∞—Ç–∏—á–Ω–∞. –ó–∞—Ç–µ–º –æ–Ω –≤—ã—á–∏—Å–ª—è–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π SHA-256 —Ö—ç—à –∏ —Å–æ–±–∏—Ä–∞–µ—Ç –≤–∞–ª–∏–¥–Ω—ã–π URL –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞ –±–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

**–í–ª–∏—è–Ω–∏–µ:**

–û–±—Ö–æ–¥ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏. –ê—Ç–∞–∫—É—é—â–∏–µ –º–æ–≥—É—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –≤–∞–ª–∏–¥–Ω—ã–µ —Å—Å—ã–ª–∫–∏ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∏ –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –æ—Ç –∏–º–µ–Ω–∏ –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

**–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞:**

- **–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `app/Services/QR/NoAuth/QrService.php (line 106)`  
  - **–î–µ—Ç–∞–ª–∏:** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `crypt()` —Å–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–æ–ª—å—é `'d24'`.  
- **–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `app/Http/Requests/Qr/NoAuth/GenerateNoAuthLinkFormRequest.php (line 110)`  
  - **–î–µ—Ç–∞–ª–∏:** –ª–æ–≥–∏–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –æ–ø–∏—Ä–∞–µ—Ç—Å—è –Ω–∞ —Å–ª–∞–±–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ `encrypted`.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `encrypt()` (AES-256) –≤–º–µ—Å—Ç–æ `crypt()`. –î–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `hash_hmac()` —Å —Å–µ–∫—Ä–µ—Ç–Ω—ã–º –∫–ª—é—á–æ–º.

## A03:2021 ‚Äî –ò–Ω—ä–µ–∫—Ü–∏–∏

### SQL-–∏–Ω—ä–µ–∫—Ü–∏—è –≤ PrepareDownloadMultipleJob

**Severity:** üö® **CRITICAL**

**CWE:** CWE-89

**–û–ø–∏—Å–∞–Ω–∏–µ:**

–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è SQL-–∏–Ω—ä–µ–∫—Ü–∏—è –≤ `app/Jobs/PrepareDownloadMultipleJob.php`. –ú–∞—Å—Å–∏–≤ `file_uuids` –∏–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞ –Ω–∞–ø—Ä—è–º—É—é –∫–æ–Ω–∫–∞—Ç–µ–Ω–∏—Ä—É–µ—Ç—Å—è –≤ raw SQL-–∑–∞–ø—Ä–æ—Å —á–µ—Ä–µ–∑ `implode` –±–µ–∑ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏–∏/–±–∏–Ω–¥–∏–Ω–≥–∞. –ü—Ä–∞–≤–∏–ª–æ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤ `PrepareDownloadMultipleRequest` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ª–∏—à—å —Ç–æ, —á—Ç–æ `file_uuids` ‚Äî —ç—Ç–æ –º–∞—Å—Å–∏–≤, –Ω–æ –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ —ç–ª–µ–º–µ–Ω—Ç—ã —è–≤–ª—è—é—Ç—Å—è –≤–∞–ª–∏–¥–Ω—ã–º–∏ UUID.

**–°—Ü–µ–Ω–∞—Ä–∏–π –∞—Ç–∞–∫–∏:**

–ê—Ç–∞–∫—É—é—â–∏–π –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ `/api/download-multiple` (–∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π `PrepareDownloadMultipleRequest`) —Å payload –≤–∏–¥–∞ `{"file_uuids": ["') UNION SELECT password FROM users --"], "mode": "zip"}`. `PrepareDownloadMultipleJob` –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–ø—Ä–æ—Å –≤–∏–¥–∞ `... AND uuid in ('') UNION SELECT password FROM users --') ...`, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–≤–ª–µ–∫–∞—Ç—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–ª–∏ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –ë–î.

**–í–ª–∏—è–Ω–∏–µ:**

–ü–æ–ª–Ω—ã–π –∫–æ–º–ø—Ä–æ–º–∏—Å—Å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, —ç–∫—Å—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ –∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–µ.

**–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞:**

- **–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `app/Jobs/PrepareDownloadMultipleJob.php`  
  - **–î–µ—Ç–∞–ª–∏:** —É—è–∑–≤–∏–º–∞—è —Å–±–æ—Ä–∫–∞ SQL-–∑–∞–ø—Ä–æ—Å–∞ —á–µ—Ä–µ–∑ `implode` –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º—É –≤–≤–æ–¥—É.  
- **–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `app/Http/Requests/PrepareDownloadMultipleRequest.php`  
  - **–î–µ—Ç–∞–ª–∏:** –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –º–∞—Å—Å–∏–≤–∞ `file_uuids`.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**

–í `PrepareDownloadMultipleRequest` –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã `file_uuids` –∫–∞–∫ UUID –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã/–±–∏–Ω–¥–∏–Ω–≥ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤–º–µ—Å—Ç–æ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏–∏.

## A04:2021 ‚Äî –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π –¥–∏–∑–∞–π–Ω

### –ò—Å—á–µ—Ä–ø–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞

**Severity:** üö® **CRITICAL**

**CWE:** CWE-770

**–û–ø–∏—Å–∞–Ω–∏–µ:**

–ö–ª–∞—Å—Å `AttachDocumentRequest` –≤—ã—á–∏—Å–ª—è–µ—Ç —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞, –∑–∞–≥—Ä—É–∂–∞—è –≤—Å—ë —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ –≤ –ø–∞–º—è—Ç—å —á–µ—Ä–µ–∑ `strlen(EncryptedStorageService::get($path))`. –≠—Ç–æ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ –∏ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –∏—Å—á–µ—Ä–ø–∞–Ω–∏—é –ø–∞–º—è—Ç–∏.

**–°—Ü–µ–Ω–∞—Ä–∏–π –∞—Ç–∞–∫–∏:**

–ê—Ç–∞–∫—É—é—â–∏–π –∑–∞–≥—Ä—É–∂–∞–µ—Ç –±–æ–ª—å—à–æ–π —Ñ–∞–π–ª (–Ω–∞–ø—Ä–∏–º–µ—Ä, 1GB) –≤ —ç–Ω–¥–ø–æ–∏–Ω—Ç `attach-document`. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—ã—Ç–∞–µ—Ç—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å—é —Å—Ç—Ä–æ–∫—É —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Ñ–∞–π–ª–∞ –≤ –ø–∞–º—è—Ç—å, —á—Ç–æ–±—ã –ø–æ—Å—á–∏—Ç–∞—Ç—å –¥–ª–∏–Ω—É, –ø—Ä–æ—Ü–µ—Å—Å PHP –ø–∞–¥–∞–µ—Ç –ø–æ OOM. –ü–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –∑–∞–ø—Ä–æ—Å—ã –º–æ–≥—É—Ç ¬´—É—Ä–æ–Ω–∏—Ç—å¬ª —Å–µ—Ä–≤–∏—Å.

**–í–ª–∏—è–Ω–∏–µ:**

–û—Ç–∫–∞–∑ –≤ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–∏ (DoS).

**–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞:**

- **–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `app/Http/Requests/AttachDocumentRequest.php`  
  - **–î–µ—Ç–∞–ª–∏:** –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø–æ–¥—Å—á—ë—Ç —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞ —á–µ—Ä–µ–∑ `strlen()` –ø–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥ –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –∏–∑ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, `EncryptedStorageService::size()`), –Ω–µ –∑–∞–≥—Ä—É–∂–∞—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤ –ø–∞–º—è—Ç—å.

## A05:2021 ‚Äî –û—à–∏–±–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤

**Severity:** üö® **MEDIUM**

**CWE:** CWE-434

**–û–ø–∏—Å–∞–Ω–∏–µ:**

–ö–ª–∞—Å—Å—ã `StoreFileRequest` –∏ `StoreFile1cRequest` –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞, –Ω–æ –Ω–µ –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç MIME-—Ç–∏–ø –∏–ª–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å —Ñ–∞–π–ª—ã –ª—é–±–æ–≥–æ —Ç–∏–ø–∞.

**–°—Ü–µ–Ω–∞—Ä–∏–π –∞—Ç–∞–∫–∏:**

–ê—Ç–∞–∫—É—é—â–∏–π (—Å –¥–æ—Å—Ç—É–ø–æ–º –∫ API/–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ 1C) –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Ñ–∞–π–ª –ª—é–±–æ–≥–æ —Ç–∏–ø–∞, —Ç.–∫. –≤ StoreFileRequest / StoreFile1cRequest –Ω–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –ø–æ MIME/—Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é (—Ç–æ–ª—å–∫–æ file|max:20480). –î–∞–ª—å—à–µ –≤–æ–∑–º–æ–∂–Ω—ã –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –≤–µ—Ç–æ–∫:

- Stored XSS / –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç: –∑–∞–≥—Ä—É–∑–∫–∞ \*.html, \*.svg (–∏ –¥—Ä. –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞) –∏ –ø–æ—Å–ª–µ–¥—É—é—â–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å—Å—ã–ª–∫–∏/—à–∞—Ä—ã –∫–æ–ª–ª–µ–≥–∞–º. –ü—Ä–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–∏/–æ—Ç–∫—Ä—ã—Ç–∏–∏ —Ñ–∞–π–ª –±—É–¥–µ—Ç –æ—Ç–¥–∞–≤–∞—Ç—å—Å—è —Å Content-Type –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è, –ø–æ—ç—Ç–æ–º—É –±—Ä–∞—É–∑–µ—Ä –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª–Ω–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ–≥–æ, –∫–∞–∫ –∏–º–µ–Ω–Ω–æ –∫–ª–∏–µ–Ω—Ç/–±—Ä–∞—É–∑–µ—Ä –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å–∫–∞—á–∞–Ω–Ω—ã–π —Ñ–∞–π–ª).  
- –ê—Ç–∞–∫–∞ —á–µ—Ä–µ–∑ –ø—Ä–µ–≤—å—é/–∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—é: –∑–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–∑—ã–≤–∞–µ—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –ø—Ä–µ–≤—å—é (—É –≤–∞—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Unoconv/LibreOffice). –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –ø–æ–¥–±–∏—Ä–∞–µ—Ç —Ñ–∞–π–ª, —ç–∫—Å–ø–ª—É–∞—Ç–∏—Ä—É—é—â–∏–π —É—è–∑–≤–∏–º–æ—Å—Ç—å –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä–∞, –∏ –¥–æ–±–∏–≤–∞–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–¥–∞/–∫–æ–º–∞–Ω–¥ –≤ –æ–∫—Ä—É–∂–µ–Ω–∏–∏ —Å–µ—Ä–≤–∏—Å–∞, –∫–æ–≥–¥–∞ –∫—Ç–æ-—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –ø—Ä–µ–≤—å—é.  
- –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤: –∑–∞–≥—Ä—É–∑–∫–∞ \*.docm/–∞—Ä—Ö–∏–≤–æ–≤ —Å ‚Äú–≤–ª–æ–∂–µ–Ω–Ω–æ–π‚Äù –º–∞–ª–≤–∞—Ä—å—é –∏ –¥–∞–ª—å–Ω–µ–π—à–µ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ ‚Äú–¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–π‚Äù —Å–µ—Ä–≤–∏—Å –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (—Å–æ—Ü–∏–∞–ª—å–Ω–∞—è –∏–Ω–∂–µ–Ω–µ—Ä–∏—è).

**–í–ª–∏—è–Ω–∏–µ:**

- –ö–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–∫—Ä–∞–∂–∞ —Ç–æ–∫–µ–Ω–æ–≤/—Å–µ—Å—Å–∏–π, –ø–æ–¥–º–µ–Ω–∞ –¥–µ–π—Å—Ç–≤–∏–π –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ) –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º Stored XSS/–æ—Ç–∫—Ä—ã—Ç–∏–∏ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞.  
- –ö–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ —Ü–µ–ø–æ—á–∫–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–µ–≤—å—é/–∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ (–ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ RCE –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ/—Ö–æ—Å—Ç–µ, –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º, pivot –≤–Ω—É—Ç—Ä–∏ —Å–µ—Ç–∏).  
- –£—Ç–µ—á–∫–∞/–ø–æ–¥–º–µ–Ω–∞ –¥–∞–Ω–Ω—ã—Ö –∏ —Ä–µ–ø—É—Ç–∞—Ü–∏–æ–Ω–Ω—ã–π —É—â–µ—Ä–± –∏–∑‚Äë–∑–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ö—Ä–∞–Ω–∏—Ç—å –∏ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è—Ç—å –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ/–≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ —Ñ–∞–π–ª—ã ‚Äú–æ—Ç –∏–º–µ–Ω–∏‚Äù –ª–µ–≥–∏—Ç–∏–º–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞.

**–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞:**

- **–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `app/Http/Requests/StoreFileRequest.php (line 58)`  
  - **–î–µ—Ç–∞–ª–∏:** –ø—Ä–∞–≤–∏–ª–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ä–∞–∑—Ä–µ—à–∞—é—Ç –ª—é–±–æ–π —Ç–∏–ø: `'file' => 'file|max:20480'`.  
- **–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `app/Http/Requests/File1C/StoreFile1cRequest.php (line 29)`  
  - **–î–µ—Ç–∞–ª–∏:** –ø—Ä–∞–≤–∏–ª–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ä–∞–∑—Ä–µ—à–∞—é—Ç –ª—é–±–æ–π —Ç–∏–ø: `'file' => 'required|file|max:20480'`.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**

–î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–≥—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é MIME-—Ç–∏–ø–∞ –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Ñ–∞–π–ª–∞ –≤ request-–∫–ª–∞—Å—Å—ã.

---

### –ñ—ë—Å—Ç–∫–æ –∑–∞–¥–∞–Ω–Ω—ã–π –∫–ª—é—á —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

**Severity:** üö® **CRITICAL**

**CWE:** CWE-321

**–û–ø–∏—Å–∞–Ω–∏–µ:**

–§–∞–π–ª `.env.example` —Å–æ–¥–µ—Ä–∂–∏—Ç –∂—ë—Å—Ç–∫–æ –∑–∞–¥–∞–Ω–Ω—ã–π `FILE_ENCRYPTION_KEY`. –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –º–æ–≥—É—Ç –æ—à–∏–±–æ—á–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –∫–ª—é—á –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ, –ª–∏–±–æ –æ–Ω –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞—Å–∫—Ä—ã—Ç, –µ—Å–ª–∏ —Ñ–∞–π–ª –¥–æ—Å—Ç—É–ø–µ–Ω –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫—É.

**–°—Ü–µ–Ω–∞—Ä–∏–π –∞—Ç–∞–∫–∏:**

–ê—Ç–∞–∫—É—é—â–∏–π, –ø–æ–ª—É—á–∏–≤—à–∏–π –¥–æ—Å—Ç—É–ø –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É –∫–æ–¥—É –∏–ª–∏ `.env.example`, –Ω–∞—Ö–æ–¥–∏—Ç –∂—ë—Å—Ç–∫–æ –∑–∞–¥–∞–Ω–Ω—ã–π –∫–ª—é—á —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è. –ó–∞—Ç–µ–º –æ–Ω –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –∫–ª—é—á –¥–ª—è —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤, —Ö—Ä–∞–Ω—è—â–∏—Ö—Å—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º.

**–í–ª–∏—è–Ω–∏–µ:**

–£—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö, –ø–æ—Ç–µ—Ä—è –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏.

**–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞:**

- **–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `.env.example (line 56)`  
  - **–î–µ—Ç–∞–ª–∏:** –∂—ë—Å—Ç–∫–æ –∑–∞–¥–∞–Ω–Ω—ã–π `FILE_ENCRYPTION_KEY=w9VDvenKYpdcRAfrAh0IKSmRJW1JYii4`.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**

–£–±—Ä–∞—Ç—å –∫–ª—é—á –∏–∑ `.env.example` –∏ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ –æ–Ω –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –±–µ–∑–æ–ø–∞—Å–Ω–æ –∏ —Ö—Ä–∞–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è.

## A06:2021 ‚Äî –£—è–∑–≤–∏–º—ã–µ –∏ —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### –ò–∑–≤–µ—Å—Ç–Ω—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö

**Severity:** üö® **CRITICAL**

**CWE:** CWE-347

**–û–ø–∏—Å–∞–Ω–∏–µ:**

–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –≤–µ—Ä—Å–∏—è `lcobucci/jwt` `3.4.4`. –í–µ—Ä—Å–∏–∏ \< 3.4.6 —É—è–∑–≤–∏–º—ã –∫ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–µ –ø–æ–¥–ø–∏—Å–∏ (CVE-2021-21245). –¢–∞–∫–∂–µ `guzzlehttp/guzzle` 6.5.5 —É—è–∑–≤–∏–º –∫ CVE-2022-31090.

**–°—Ü–µ–Ω–∞—Ä–∏–π –∞—Ç–∞–∫–∏:**

–ê—Ç–∞–∫—É—é—â–∏–π –º–æ–∂–µ—Ç –æ–±–æ–π—Ç–∏ –ø—Ä–æ–≤–µ—Ä–∫—É –ø–æ–¥–ø–∏—Å–∏ JWT-—Ç–æ–∫–µ–Ω–æ–≤, –µ—Å–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —É—è–∑–≤–∏–º—É—é –≤–µ—Ä—Å–∏—é `lcobucci/jwt` (CVE-2021-21245), —á—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –ø–æ–¥–¥–µ–ª—ã–≤–∞—Ç—å —Ç–æ–∫–µ–Ω—ã –∏ –≤—ã–¥–∞–≤–∞—Ç—å —Å–µ–±—è –∑–∞ –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

**–í–ª–∏—è–Ω–∏–µ:**

–û–±—Ö–æ–¥ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (JWT) –∏ —Ä–∞—Å–∫—Ä—ã—Ç–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ (Guzzle).

**–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞:**

- **–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `composer.lock`  
  - **–î–µ—Ç–∞–ª–∏:** `"name": "lcobucci/jwt", "version": "3.4.4"`  
- **–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `composer.lock`  
  - **–î–µ—Ç–∞–ª–∏:** `"name": "guzzlehttp/guzzle", "version": "6.5.5"`

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**

–û–±–Ω–æ–≤–∏—Ç—å `lcobucci/jwt` –¥–æ –≤–µ—Ä—Å–∏–∏ \>= 3.4.6 –∏ `guzzlehttp/guzzle` –¥–æ –≤–µ—Ä—Å–∏–∏ \>= 6.5.8.

## A07:2021 ‚Äî –°–±–æ–∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

## A08:2021 ‚Äî –°–±–æ–∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –∏ –¥–∞–Ω–Ω—ã—Ö

### –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

**Severity:** üö® **CRITICAL**

**CWE:** CWE-494

**–û–ø–∏—Å–∞–Ω–∏–µ:**

–°–∫—Ä–∏–ø—Ç `deploy.sh` –≤—ã–ø–æ–ª–Ω—è–µ—Ç `composer update`, —á—Ç–æ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç lock-—Ñ–∞–π–ª –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–æ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –≤–µ—Ä—Å–∏–π. –≠—Ç–æ –ø–æ–¥—Ä—ã–≤–∞–µ—Ç –≥–∞—Ä–∞–Ω—Ç–∏–∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ –¥–∞—ë—Ç `composer.lock`, –∏ –ø–æ–¥–≤–µ—Ä–≥–∞–µ—Ç –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Ä–∏—Å–∫—É –Ω–µ–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞ –∏ –∞—Ç–∞–∫ –Ω–∞ —Ü–µ–ø–æ—á–∫—É –ø–æ—Å—Ç–∞–≤–∫–∏.

**–°—Ü–µ–Ω–∞—Ä–∏–π –∞—Ç–∞–∫–∏:**

–í–æ –≤—Ä–µ–º—è –¥–µ–ø–ª–æ—è –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è `composer update`. –û–¥–Ω–∞ –∏–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –ø—Ä–æ–µ–∫—Ç–∞ –º–æ–≥–ª–∞ –Ω–µ–¥–∞–≤–Ω–æ –≤—ã–ø—É—Å—Ç–∏—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—É—é –≤–µ—Ä—Å–∏—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–∑\-–∑–∞ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏ –∞–∫–∫–∞—É–Ω—Ç–∞ –º–µ–π–Ω—Ç–µ–π–Ω–µ—Ä–∞) –∏–ª–∏ –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ. –°–∫—Ä–∏–ø—Ç –¥–µ–ø–ª–æ—è –ø–æ–¥—Ç—è–≥–∏–≤–∞–µ—Ç —ç—Ç—É –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é –≤–º–µ—Å—Ç–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –∏–∑ `composer.lock`, —á—Ç–æ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä—É–µ—Ç –ø—Ä–æ–¥–∞–∫—à–µ–Ω –∏–ª–∏ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –æ—Ç–∫–∞–∑—É –≤ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–∏.

**–í–ª–∏—è–Ω–∏–µ:**

–í—ã—Å–æ–∫–æ–µ. –†–∏—Å–∫ –≤–Ω–µ—Å–µ–Ω–∏—è —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π, –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û –∏–ª–∏ –ª–æ–º–∞—é—â–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–∞–ø—Ä—è–º—É—é –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω.

**–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞:**

- **–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `deploy.sh`  
  - **–î–µ—Ç–∞–ª–∏:** `composer update`.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**

–ó–∞–º–µ–Ω–∏—Ç—å `composer update` –Ω–∞ `composer install --no-dev --optimize-autoloader` –≤ —Å–∫—Ä–∏–ø—Ç–µ –¥–µ–ø–ª–æ—è.

## A09:2021 ‚Äî –°–±–æ–∏ –∂—É—Ä–Ω–∞–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–∫–∞–∑–æ–≤ –≤ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

**Severity:** üö® **CRITICAL**

**CWE:** CWE-778

**–û–ø–∏—Å–∞–Ω–∏–µ:**

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –∏—Å–∫–ª—é—á–µ–Ω–∏–π Laravel, –∫–æ—Ç–æ—Ä–∞—è –æ–±—ã—á–Ω–æ –∏—Å–∫–ª—é—á–∞–µ—Ç `AuthorizationException` (403) –∏ `ModelNotFoundException` (404) –∏–∑ –ª–æ–≥–æ–≤. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —Å–æ–±—ã—Ç–∏—è –æ—Ç–∫–∞–∑–∞ –≤ –¥–æ—Å—Ç—É–ø–µ –Ω–µ —Ñ–∏–∫—Å–∏—Ä—É—é—Ç—Å—è, –æ–±—Ä–∞–∑—É—è ¬´—Å–ª–µ–ø—É—é –∑–æ–Ω—É¬ª –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

**–°—Ü–µ–Ω–∞—Ä–∏–π –∞—Ç–∞–∫–∏:**

–ê—Ç–∞–∫—É—é—â–∏–π –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Ä–µ—Å—É—Ä—Å–∞–º, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ —É –Ω–µ–≥–æ –Ω–µ—Ç –ø—Ä–∞–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫ —Ñ–∞–π–ª–∞–º –¥—Ä—É–≥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è). –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—Ç–∫–∞–∑ (403), –Ω–æ —Ç–∞–∫ –∫–∞–∫ —Å–æ–±—ã—Ç–∏–µ –Ω–µ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è, –∫–æ–º–∞–Ω–¥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –Ω–µ –≤–∏–¥–∏—Ç –ø–æ–ø—ã—Ç–æ–∫ –ø–µ—Ä–µ–±–æ—Ä–∞/–ø—Ä–æ—â—É–ø—ã–≤–∞–Ω–∏—è.

**–í–ª–∏—è–Ω–∏–µ:**

–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å –∏ —Å–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–æ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –ø–æ–ø—ã—Ç–∫–∏ –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞, –ø—Ä–æ–±–∏–Ω–≥ —ç—Å–∫–∞–ª–∞—Ü–∏–∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π –∏–ª–∏ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—é IDOR.

**–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞:**

- **–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `app/Exceptions/Handler.php`  
  - **–î–µ—Ç–∞–ª–∏:** `Handler::report` –≤—ã–∑—ã–≤–∞–µ—Ç `parent::report`, –∫–æ—Ç–æ—Ä—ã–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç `AuthorizationException`.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**

–ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å `report` –≤ `Handler.php`, —á—Ç–æ–±—ã —è–≤–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å `AuthorizationException` —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

## A10:2021 ‚Äî Server-Side Request Forgery (SSRF)

### XXE-–∏–Ω—ä–µ–∫—Ü–∏—è (XML External Entity)

**Severity:** üö® **CRITICAL**

**CWE:** CWE-611

**–û–ø–∏—Å–∞–Ω–∏–µ:**

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `SimpleXMLElement` –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ XML, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º, –±–µ–∑ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤–Ω–µ—à–Ω–∏—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π. –≠—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ `FileSignatureController::update` –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –ø–æ–¥–ø–∏—Å–∏ –∏ –≤ `UUIDFileService::getSignatureContent` –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–µ–π. –≠—Ç–æ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è XXE-—É—è–∑–≤–∏–º–æ—Å—Ç—å.

**–°—Ü–µ–Ω–∞—Ä–∏–π –∞—Ç–∞–∫–∏:**

–ê—Ç–∞–∫—É—é—â–∏–π –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–¥–ø–∏—Å—å —Ñ–∞–π–ª–∞ —Å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º XML payload (–Ω–∞–ø—Ä–∏–º–µ—Ä, `<!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]><root>&xxe;</root>`). –ö–æ–≥–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —ç—Ç—É –ø–æ–¥–ø–∏—Å—å –≤ `FileSignatureController::update` –∏–ª–∏ `UUIDFileService::getSignatureContent`, –æ–Ω–æ –ø–∞—Ä—Å–∏—Ç XML –∏ —Ä–µ–∑–æ–ª–≤–∏—Ç –≤–Ω–µ—à–Ω—é—é —Å—É—â–Ω–æ—Å—Ç—å, –ø–æ–∑–≤–æ–ª—è—è –∞—Ç–∞–∫—É—é—â–µ–º—É —á–∏—Ç–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –∏–ª–∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å HTTP-–∑–∞–ø—Ä–æ—Å—ã –≤–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã.

**–í–ª–∏—è–Ω–∏–µ:**

–í—ã—Å–æ–∫–æ–µ. –ú–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —Ä–∞—Å–∫—Ä—ã—Ç–∏—é –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ (LFD), SSRF –∏ –æ—Ç–∫–∞–∑—É –≤ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–∏ (DoS).

**–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞:**

- **–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `app/Http/Controllers/FileSignatureController.php (line 350)`  
  - **–î–µ—Ç–∞–ª–∏:** –ø—Ä—è–º–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ `SimpleXMLElement` –∏–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞ `$updateFileSignatureRequest->signature` –±–µ–∑ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è —Å—É—â–Ω–æ—Å—Ç–µ–π.  
- **–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `app/Services/UUIDFileService.php (line 120)`  
  - **–î–µ—Ç–∞–ª–∏:** –ø—Ä—è–º–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ `SimpleXMLElement` –∏–∑ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–∏.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**

–ü–µ—Ä–µ–¥ –ø–∞—Ä—Å–∏–Ω–≥–æ–º XML –æ—Ç–∫–ª—é—á–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –≤–Ω–µ—à–Ω–∏—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π, –∏—Å–ø–æ–ª—å–∑—É—è `libxml_disable_entity_loader(true)`.  
